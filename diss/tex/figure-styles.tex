% Copyright (c) 2017, Gabriel Hjort Blindell <ghb@kth.se>
%
% This work is licensed under a Creative Commons 4.0 International License (see
% LICENSE file or visit <http://creativecommons.org/licenses/by/4.0/> for a copy
% of the license).

\usetikzlibrary{%
  calc,%
  fit,%
  intersections,%
  positioning,%
  shapes,%
}

\newcommand{\figureFont}{\sffamily}
\newcommand{\figureFontSize}{\small}

\colorlet{shade0}{black!0!white}
\colorlet{shade1}{black!20!white}
\colorlet{shade2}{black!40!white}
\colorlet{shade3}{black!60!white}
\colorlet{shade4}{black!80!white}
\newlength{\opNodeDist}
\setlength{\opNodeDist}{16pt}
\newlength{\opNodeSize}
\setlength{\opNodeSize}{14pt}
\newlength{\opDataFlowLineWidth}
\setlength{\opDataFlowLineWidth}{.6pt}
\newlength{\opControlFlowLineWidth}
\setlength{\opControlFlowLineWidth}{1.2pt}
\newlength{\opControlFlowLabelXSep}
\setlength{\opControlFlowLabelXSep}{4pt}
\tikzset{%
  every picture/.style={%
    >=stealth,
  },
  nothing/.style={%
    draw=none,
    fill=none,
    minimum size=0,
    inner sep=0,
    outer sep=0,
  },
  op node/.style={%
    draw,
    fill=shade0,
    circle,
    minimum size=\opNodeSize,
    inner sep=0,
    outer sep=0,
    node distance=\opNodeDist,
    line width=\opDataFlowLineWidth,
    font=\relsize{-.5},
  },
  control node/.style={%
    op node,
    diamond,
    line width=\opControlFlowLineWidth,
  },
  value node/.style={%
    rectangle,
    draw,
    fill=shade0,
    minimum size=0.7\opNodeSize,
    inner sep=0,
    outer sep=0,
    node distance=\opNodeDist,
    line width=\opDataFlowLineWidth,
    font=\relsize{-.5},
  },
  block node/.style={%
    rectangle,
    draw,
    fill=shade0,
    minimum size=0.8\opNodeSize,
    inner xsep=4pt,
    inner ysep=0,
    outer sep=0,
    node distance=\opNodeDist,
    line width=\opControlFlowLineWidth,
    font=\relsize{-.5}\strut,
  },
  data flow/.style={%
    ->,
    line width=\opDataFlowLineWidth,
  },
  control flow/.style={%
    ->,
    line width=\opControlFlowLineWidth,
    shorten <=-\opControlFlowLineWidth,
  },
  control-flow label/.style={
    nothing,
    inner xsep=\opControlFlowLabelXSep,
    node distance=0,
    font=\sffamily,
    auto,
  },
  match line/.style={%
    dash pattern=on 2.5pt off 3pt,
    line width=\opDataFlowLineWidth,
  },
  match node/.style={%
    match line,
    draw,
    circle,
    inner sep=1pt,
    outer sep=0,
  },
}
\makeatletter
\tikzset{
  position/.style args={#1 degrees from #2}{%
    at=(#2.#1), anchor=#1+180, shift=(#1:\tikz@node@distance),
  },
}
\makeatother
